import os
import sys
import hashlib
import shutil


def md5(fname):
    hash_md5 = hashlib.md5()
    with open(fname, "rb") as f:
        for chunk in iter(lambda: f.read(4096), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()


def get_file_paths(directory):
    file_paths = []
    for root, directories, files in os.walk(directory):
        for filename in files:
            filepath = os.path.join(root, filename)
            file_paths.append(filepath)
    return file_paths


def main():
    directory = sys.argv[1]
    file_paths = get_file_paths(directory)
    for file_path in file_paths:
        file_hash = md5(file_path)
        if file_hash in malicious_files:
            print(file_path)
            print(file_hash)
            print("Would you like to keep, quarantine or delete this file?")
            user_input = input()
            if user_input == "keep":
                continue
            elif user_input == "quarantine":
                shutil.move(file_path, quarantine_dir)
            elif user_input == "delete":
                os.remove(file_path)
            else:
                print("Invalid input")


if __name__ == "__main__":
    malicious_files = ["d41d8cd98f00b204e9800998ecf8427e", "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"]
    quarantine_dir = "quarantine"
    main()
